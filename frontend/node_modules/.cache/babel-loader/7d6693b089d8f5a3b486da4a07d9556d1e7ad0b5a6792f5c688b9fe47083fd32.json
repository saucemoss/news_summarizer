{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import NewsCard from'./components/NewsCard';import NewsDetails from'./components/NewsDetails';import SkeletonCard from'./components/SkeletonCard';import useInfiniteScroll from'./hooks/useInfiniteScroll';import{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";function App(){const[articles,setArticles]=useState([]);const[selectedArticle,setSelectedArticle]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[hasMore,setHasMore]=useState(true);const[page,setPage]=useState(0);const[loadingMore,setLoadingMore]=useState(false);const fetchArticles=useCallback(async function(){let pageNum=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;console.log('Fetching articles for page:',pageNum);try{const response=await fetch(`http://127.0.0.1:8000/api/articles?skip=${pageNum*10}&limit=10`);if(!response.ok){throw new Error('Failed to fetch articles');}const data=await response.json();console.log('Received articles:',{count:data.articles.length,hasMore:data.has_more,total:data.total});if(pageNum===0){setArticles(data.articles);}else{setArticles(prev=>[...prev,...data.articles]);}setHasMore(data.has_more);setPage(pageNum);setLoading(false);setLoadingMore(false);}catch(err){console.error('Error fetching articles:',err);setError(err.message);setLoading(false);setLoadingMore(false);}},[]);useEffect(()=>{fetchArticles(0);},[fetchArticles]);const loadMore=useCallback(()=>{console.log('loadMore called',{loadingMore,hasMore,page});if(!loadingMore&&hasMore){console.log('Starting to load more articles...');setLoadingMore(true);fetchArticles(page+1);}else{console.log('Skipping load more:',{loadingMore,hasMore});}},[fetchArticles,loadingMore,hasMore,page]);const[triggerRef]=useInfiniteScroll(loadMore,hasMore,articles);const handleArticleClick=async article=>{try{const response=await fetch(`http://127.0.0.1:8000/api/articles/${article.id}`);if(!response.ok){throw new Error('Failed to fetch article details');}const fullArticle=await response.json();setSelectedArticle(fullArticle);}catch(err){setError(err.message);}};if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-900 text-white p-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-red-500\",children:[\"Error: \",error]})})});}return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-900 text-white\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto p-4\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold mb-8\",children:\"News Summarizer\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-1/2 space-y-4\",children:loading?/*#__PURE__*/_jsx(SkeletonCard,{}):/*#__PURE__*/_jsxs(_Fragment,{children:[articles.map(article=>/*#__PURE__*/_jsx(\"div\",{onClick:()=>handleArticleClick(article),children:/*#__PURE__*/_jsx(NewsCard,{title:article.title,summary:article.summary,processed_at:article.processed_at})},article.id)),loadingMore&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center py-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-white\"})}),/*#__PURE__*/_jsx(\"div\",{ref:triggerRef,className:\"h-4\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-1/2\",children:selectedArticle?/*#__PURE__*/_jsx(NewsDetails,{article:selectedArticle}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400 text-center\",children:\"Select an article to view details\"})})]})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useCallback","NewsCard","NewsDetails","SkeletonCard","useInfiniteScroll","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","App","articles","setArticles","selectedArticle","setSelectedArticle","loading","setLoading","error","setError","hasMore","setHasMore","page","setPage","loadingMore","setLoadingMore","fetchArticles","pageNum","arguments","length","undefined","console","log","response","fetch","ok","Error","data","json","count","has_more","total","prev","err","message","loadMore","triggerRef","handleArticleClick","article","id","fullArticle","className","children","map","onClick","title","summary","processed_at","ref"],"sources":["C:/dev/news_summarizer_cr_aws/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport NewsCard from './components/NewsCard';\nimport NewsDetails from './components/NewsDetails';\nimport SkeletonCard from './components/SkeletonCard';\nimport useInfiniteScroll from './hooks/useInfiniteScroll';\n\nfunction App() {\n  const [articles, setArticles] = useState([]);\n  const [selectedArticle, setSelectedArticle] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [hasMore, setHasMore] = useState(true);\n  const [page, setPage] = useState(0);\n  const [loadingMore, setLoadingMore] = useState(false);\n\n  const fetchArticles = useCallback(async (pageNum = 0) => {\n    console.log('Fetching articles for page:', pageNum);\n    try {\n      const response = await fetch(`http://127.0.0.1:8000/api/articles?skip=${pageNum * 10}&limit=10`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch articles');\n      }\n      const data = await response.json();\n      \n      console.log('Received articles:', {\n        count: data.articles.length,\n        hasMore: data.has_more,\n        total: data.total\n      });\n      \n      if (pageNum === 0) {\n        setArticles(data.articles);\n      } else {\n        setArticles(prev => [...prev, ...data.articles]);\n      }\n      \n      setHasMore(data.has_more);\n      setPage(pageNum);\n      setLoading(false);\n      setLoadingMore(false);\n    } catch (err) {\n      console.error('Error fetching articles:', err);\n      setError(err.message);\n      setLoading(false);\n      setLoadingMore(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchArticles(0);\n  }, [fetchArticles]);\n\n  const loadMore = useCallback(() => {\n    console.log('loadMore called', { loadingMore, hasMore, page });\n    if (!loadingMore && hasMore) {\n      console.log('Starting to load more articles...');\n      setLoadingMore(true);\n      fetchArticles(page + 1);\n    } else {\n      console.log('Skipping load more:', { loadingMore, hasMore });\n    }\n  }, [fetchArticles, loadingMore, hasMore, page]);\n\n  const [triggerRef] = useInfiniteScroll(loadMore, hasMore, articles);\n\n  const handleArticleClick = async (article) => {\n    try {\n      const response = await fetch(`http://127.0.0.1:8000/api/articles/${article.id}`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch article details');\n      }\n      const fullArticle = await response.json();\n      setSelectedArticle(fullArticle);\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gray-900 text-white p-4\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"text-red-500\">Error: {error}</div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-900 text-white\">\n      <div className=\"max-w-7xl mx-auto p-4\">\n        <h1 className=\"text-3xl font-bold mb-8\">News Summarizer</h1>\n        \n        <div className=\"flex gap-4\">\n          {/* Left side - Article List */}\n          <div className=\"w-1/2 space-y-4\">\n            {loading ? (\n              <SkeletonCard />\n            ) : (\n              <>\n                {articles.map((article) => (\n                  <div key={article.id} onClick={() => handleArticleClick(article)}>\n                    <NewsCard\n                      title={article.title}\n                      summary={article.summary}\n                      processed_at={article.processed_at}\n                    />\n                  </div>\n                ))}\n                {/* Loading indicator */}\n                {loadingMore && (\n                  <div className=\"flex justify-center py-4\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white\"></div>\n                  </div>\n                )}\n                {/* Infinite scroll trigger */}\n                <div ref={triggerRef} className=\"h-4\" />\n              </>\n            )}\n          </div>\n\n          {/* Right side - Article Details */}\n          <div className=\"w-1/2\">\n            {selectedArticle ? (\n              <NewsDetails article={selectedArticle} />\n            ) : (\n              <p className=\"text-gray-400 text-center\">\n                Select an article to view details\n              </p>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,WAAW,KAAQ,OAAO,CAC/D,MAAO,CAAAC,QAAQ,KAAM,uBAAuB,CAC5C,MAAO,CAAAC,WAAW,KAAM,0BAA0B,CAClD,MAAO,CAAAC,YAAY,KAAM,2BAA2B,CACpD,MAAO,CAAAC,iBAAiB,KAAM,2BAA2B,CAAC,OAAAC,IAAA,IAAAC,KAAA,CAAAC,GAAA,IAAAC,IAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE1D,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACgB,eAAe,CAAEC,kBAAkB,CAAC,CAAGjB,QAAQ,CAAC,IAAI,CAAC,CAC5D,KAAM,CAACkB,OAAO,CAAEC,UAAU,CAAC,CAAGnB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACoB,KAAK,CAAEC,QAAQ,CAAC,CAAGrB,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAACsB,OAAO,CAAEC,UAAU,CAAC,CAAGvB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACwB,IAAI,CAAEC,OAAO,CAAC,CAAGzB,QAAQ,CAAC,CAAC,CAAC,CACnC,KAAM,CAAC0B,WAAW,CAAEC,cAAc,CAAC,CAAG3B,QAAQ,CAAC,KAAK,CAAC,CAErD,KAAM,CAAA4B,aAAa,CAAG1B,WAAW,CAAC,gBAAuB,IAAhB,CAAA2B,OAAO,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAClDG,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAEL,OAAO,CAAC,CACnD,GAAI,CACF,KAAM,CAAAM,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,2CAA2CP,OAAO,CAAG,EAAE,WAAW,CAAC,CAChG,GAAI,CAACM,QAAQ,CAACE,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAC,KAAK,CAAC,0BAA0B,CAAC,CAC7C,CACA,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAJ,QAAQ,CAACK,IAAI,CAAC,CAAC,CAElCP,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAE,CAChCO,KAAK,CAAEF,IAAI,CAACzB,QAAQ,CAACiB,MAAM,CAC3BT,OAAO,CAAEiB,IAAI,CAACG,QAAQ,CACtBC,KAAK,CAAEJ,IAAI,CAACI,KACd,CAAC,CAAC,CAEF,GAAId,OAAO,GAAK,CAAC,CAAE,CACjBd,WAAW,CAACwB,IAAI,CAACzB,QAAQ,CAAC,CAC5B,CAAC,IAAM,CACLC,WAAW,CAAC6B,IAAI,EAAI,CAAC,GAAGA,IAAI,CAAE,GAAGL,IAAI,CAACzB,QAAQ,CAAC,CAAC,CAClD,CAEAS,UAAU,CAACgB,IAAI,CAACG,QAAQ,CAAC,CACzBjB,OAAO,CAACI,OAAO,CAAC,CAChBV,UAAU,CAAC,KAAK,CAAC,CACjBQ,cAAc,CAAC,KAAK,CAAC,CACvB,CAAE,MAAOkB,GAAG,CAAE,CACZZ,OAAO,CAACb,KAAK,CAAC,0BAA0B,CAAEyB,GAAG,CAAC,CAC9CxB,QAAQ,CAACwB,GAAG,CAACC,OAAO,CAAC,CACrB3B,UAAU,CAAC,KAAK,CAAC,CACjBQ,cAAc,CAAC,KAAK,CAAC,CACvB,CACF,CAAC,CAAE,EAAE,CAAC,CAEN1B,SAAS,CAAC,IAAM,CACd2B,aAAa,CAAC,CAAC,CAAC,CAClB,CAAC,CAAE,CAACA,aAAa,CAAC,CAAC,CAEnB,KAAM,CAAAmB,QAAQ,CAAG7C,WAAW,CAAC,IAAM,CACjC+B,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAE,CAAER,WAAW,CAAEJ,OAAO,CAAEE,IAAK,CAAC,CAAC,CAC9D,GAAI,CAACE,WAAW,EAAIJ,OAAO,CAAE,CAC3BW,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC,CAChDP,cAAc,CAAC,IAAI,CAAC,CACpBC,aAAa,CAACJ,IAAI,CAAG,CAAC,CAAC,CACzB,CAAC,IAAM,CACLS,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAE,CAAER,WAAW,CAAEJ,OAAQ,CAAC,CAAC,CAC9D,CACF,CAAC,CAAE,CAACM,aAAa,CAAEF,WAAW,CAAEJ,OAAO,CAAEE,IAAI,CAAC,CAAC,CAE/C,KAAM,CAACwB,UAAU,CAAC,CAAG1C,iBAAiB,CAACyC,QAAQ,CAAEzB,OAAO,CAAER,QAAQ,CAAC,CAEnE,KAAM,CAAAmC,kBAAkB,CAAG,KAAO,CAAAC,OAAO,EAAK,CAC5C,GAAI,CACF,KAAM,CAAAf,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,sCAAsCc,OAAO,CAACC,EAAE,EAAE,CAAC,CAChF,GAAI,CAAChB,QAAQ,CAACE,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAC,KAAK,CAAC,iCAAiC,CAAC,CACpD,CACA,KAAM,CAAAc,WAAW,CAAG,KAAM,CAAAjB,QAAQ,CAACK,IAAI,CAAC,CAAC,CACzCvB,kBAAkB,CAACmC,WAAW,CAAC,CACjC,CAAE,MAAOP,GAAG,CAAE,CACZxB,QAAQ,CAACwB,GAAG,CAACC,OAAO,CAAC,CACvB,CACF,CAAC,CAED,GAAI1B,KAAK,CAAE,CACT,mBACEV,IAAA,QAAK2C,SAAS,CAAC,yCAAyC,CAAAC,QAAA,cACtD5C,IAAA,QAAK2C,SAAS,CAAC,mBAAmB,CAAAC,QAAA,cAChC9C,KAAA,QAAK6C,SAAS,CAAC,cAAc,CAAAC,QAAA,EAAC,SAAO,CAAClC,KAAK,EAAM,CAAC,CAC/C,CAAC,CACH,CAAC,CAEV,CAEA,mBACEV,IAAA,QAAK2C,SAAS,CAAC,qCAAqC,CAAAC,QAAA,cAClD9C,KAAA,QAAK6C,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eACpC5C,IAAA,OAAI2C,SAAS,CAAC,yBAAyB,CAAAC,QAAA,CAAC,iBAAe,CAAI,CAAC,cAE5D9C,KAAA,QAAK6C,SAAS,CAAC,YAAY,CAAAC,QAAA,eAEzB5C,IAAA,QAAK2C,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAC7BpC,OAAO,cACNR,IAAA,CAACL,YAAY,GAAE,CAAC,cAEhBG,KAAA,CAAAI,SAAA,EAAA0C,QAAA,EACGxC,QAAQ,CAACyC,GAAG,CAAEL,OAAO,eACpBxC,IAAA,QAAsB8C,OAAO,CAAEA,CAAA,GAAMP,kBAAkB,CAACC,OAAO,CAAE,CAAAI,QAAA,cAC/D5C,IAAA,CAACP,QAAQ,EACPsD,KAAK,CAAEP,OAAO,CAACO,KAAM,CACrBC,OAAO,CAAER,OAAO,CAACQ,OAAQ,CACzBC,YAAY,CAAET,OAAO,CAACS,YAAa,CACpC,CAAC,EALMT,OAAO,CAACC,EAMb,CACN,CAAC,CAEDzB,WAAW,eACVhB,IAAA,QAAK2C,SAAS,CAAC,0BAA0B,CAAAC,QAAA,cACvC5C,IAAA,QAAK2C,SAAS,CAAC,2DAA2D,CAAM,CAAC,CAC9E,CACN,cAED3C,IAAA,QAAKkD,GAAG,CAAEZ,UAAW,CAACK,SAAS,CAAC,KAAK,CAAE,CAAC,EACxC,CACH,CACE,CAAC,cAGN3C,IAAA,QAAK2C,SAAS,CAAC,OAAO,CAAAC,QAAA,CACnBtC,eAAe,cACdN,IAAA,CAACN,WAAW,EAAC8C,OAAO,CAAElC,eAAgB,CAAE,CAAC,cAEzCN,IAAA,MAAG2C,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAC,mCAEzC,CAAG,CACJ,CACE,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,CAEV,CAEA,cAAe,CAAAzC,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}